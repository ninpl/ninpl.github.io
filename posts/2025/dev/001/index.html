<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Renderizar detrás de los iconos del escritorio en Windows - N9&#43;</title><meta name="Description" content="un blog sobre mi, juegos, desarrollo y anime"><meta property="og:title" content="Renderizar detrás de los iconos del escritorio en Windows" />
<meta property="og:description" content="Dibuja o renderiza un formulario de Windows directamente sobre el fondo de pantalla, detrás de los íconos del escritorio en Windows.
Introducción Quienes lean este artículo probablemente conozcan DreamScene, la función de Windows Vista que permite renderizar secuencias de vídeo (en formato .dream) como fondo de escritorio. También existe una herramienta llamada Rainmeter que permite colocar widgets, gadgets o cualquier otro elemento en el escritorio, uno encima del otro, arriba y abajo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ninpl.com/posts/2025/dev/001/" /><meta property="og:image" content="https://ninpl.com/avatar.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-03-12T18:18:21+01:00" />
<meta property="article:modified_time" content="2025-03-12T18:18:21+01:00" /><meta property="og:site_name" content="N9&#43;" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ninpl.com/avatar.png"/>

<meta name="twitter:title" content="Renderizar detrás de los iconos del escritorio en Windows"/>
<meta name="twitter:description" content="Dibuja o renderiza un formulario de Windows directamente sobre el fondo de pantalla, detrás de los íconos del escritorio en Windows.
Introducción Quienes lean este artículo probablemente conozcan DreamScene, la función de Windows Vista que permite renderizar secuencias de vídeo (en formato .dream) como fondo de escritorio. También existe una herramienta llamada Rainmeter que permite colocar widgets, gadgets o cualquier otro elemento en el escritorio, uno encima del otro, arriba y abajo."/>
<meta name="application-name" content="Nineplus">
<meta name="apple-mobile-web-app-title" content="Nineplus"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://ninpl.com/posts/2025/dev/001/" /><link rel="prev" href="https://ninpl.com/posts/2025/comun/001/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Renderizar detrás de los iconos del escritorio en Windows",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ninpl.com\/posts\/2025\/dev\/001\/"
        },"genre": "posts","keywords": "n9\u002b, dev","wordcount":  772 ,
        "url": "https:\/\/ninpl.com\/posts\/2025\/dev\/001\/","datePublished": "2025-03-12T18:18:21+01:00","dateModified": "2025-03-12T18:18:21+01:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "N9+"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="N9&#43;"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/avatar.png"
        data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x"
        data-sizes="auto"
        alt="/avatar.png"
        title="/avatar.png" /><span class="header-title-pre"><i class='fa fa-angle-right'></i></span><span id="id-7" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/devblog/"><i class='fa-solid fa-gamepad'></i> devblog </a><a class="menu-item" href="/backdoor/"><i class='fa-solid fa-user-secret'></i> backdoor </a><a class="menu-item" href="https://github.com/ninpl" rel="noopener noreffer" target="_blank"><i class='fa-solid fa-code'></i> src </a><a class="menu-item" href="/perfil/"><i class='fa-solid fa-terminal'></i> nineplus </a><span class="menu-item delimiter"></span><a class="menu-item" href="https://github.com/ninpl" title="GitHub" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-github-alt" aria-hidden="true"></i></a><a class="menu-item" href="https://gitlab.com/ninpl" title="Gitlab" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-gitlab" aria-hidden="true"></i></a><a class="menu-item" href="https://trello.com/u/antoniomoon" title="Trello" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-trello" aria-hidden="true"></i></a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Busca títulos o contenido..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Buscar">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Limpiar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="N9&#43;"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/avatar.png"
        data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x"
        data-sizes="auto"
        alt="/avatar.png"
        title="/avatar.png" /><span class="header-title-pre"><i class='fa fa-angle-right'></i></span><span id="id-8" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Busca títulos o contenido..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Buscar">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Limpiar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancelar
                    </a>
                </div><a class="menu-item" href="/devblog/" title=""><i class='fa-solid fa-gamepad'></i>devblog</a><a class="menu-item" href="/backdoor/" title=""><i class='fa-solid fa-user-secret'></i>backdoor</a><a class="menu-item" href="https://github.com/ninpl" title="" rel="noopener noreffer" target="_blank"><i class='fa-solid fa-code'></i>src</a><a class="menu-item" href="/perfil/" title=""><i class='fa-solid fa-terminal'></i>nineplus</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><article class="feature-image">
        <div class="header-img" style="background-image: url('https://ninpl.com/img/b/bg.jpg')"></div>
		</header></div>
    <article class="page single"><h1 class="single-title animate__animated animate__flipInX">Renderizar detrás de los iconos del escritorio en Windows</h1><div class="content" id="content"><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Dibuja o renderiza un formulario de Windows directamente sobre el fondo de pantalla, detrás de los íconos del escritorio en Windows.</p>
<h1 id="introducción">Introducción</h1>
<p>Quienes lean este artículo probablemente conozcan <strong>DreamScene, la función de Windows Vista que permite renderizar secuencias de vídeo (en formato .dream) como fondo de escritorio</strong>. También existe una herramienta llamada <strong>Rainmeter</strong> que permite colocar widgets, gadgets o cualquier otro elemento en el escritorio, uno encima del otro, arriba y abajo. También existe <strong>Winamp</strong>, el primer programa donde vi el renderizado de DirectX en acción detrás de los iconos del escritorio.</p>
<p>Estas herramientas tienen una cosa en común: <strong>no pueden hacerlo en Windows 8, al menos la parte de &ldquo;dibujar debajo de los íconos del escritorio&rdquo;</strong>.</p>
<h1 id="cómo-funcionaba-antes">Cómo funcionaba antes</h1>
<p>Existe el árbol de ventanas. Este árbol contiene todas las ventanas que se muestran u ocultan en el escritorio actual. Además, existe una herramienta llamada <strong>Spy++ (Visual Studio -&gt; Herramientas -&gt; Spy++)</strong>, que permite visualizar y navegar por dicho árbol. Esta herramienta forma parte de Visual Studio.</p>
<h1 id="el-código">El Código</h1>
<h3 id="obtener-la-dirección-del-administrador-del-programa">Obtener la dirección del administrador del programa</h3>
<p>Primero, <strong>buscamos el identificador de la ventana Progman</strong>. Podemos usar la función FindWindow proporcionada por la API de Windows para realizar esta tarea.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">IntPtr</span> <span class="n">progman</span> <span class="p">=</span> <span class="n">W32</span><span class="p">.</span><span class="n">FindWindow</span><span class="p">(</span><span class="s">&#34;Progman&#34;</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="enviar-mensaje-al-administrador-del-programa">Enviar mensaje al administrador del programa</h3>
<p>Para activar la <strong>creación de una ventana WorkerW</strong> entre los iconos del escritorio y el fondo de pantalla, debemos enviar un mensaje al Administrador de programas. Este mensaje no está documentado, por lo que no tiene un nombre especial en la API de Windows, <strong>excepto 0x052C</strong>. Para enviarlo, usamos el método . de la API de Windows SendMessageTimeout.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">IntPtr</span> <span class="n">result</span> <span class="p">=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">W32</span><span class="p">.</span><span class="n">SendMessageTimeout</span><span class="p">(</span><span class="n">progman</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="m">0x052C</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="k">new</span> <span class="n">IntPtr</span><span class="p">(</span><span class="m">0</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                       <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="n">W32</span><span class="p">.</span><span class="n">SendMessageTimeoutFlags</span><span class="p">.</span><span class="n">SMTO_NORMAL</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="m">1000</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="k">out</span> <span class="n">result</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="obtener-el-control-de-la-ventana-recién-creada">Obtener el control de la ventana recién creada</h3>
<p>Ahora, necesitamos obtener <strong>un identificador para la ventana WorkerW</strong> recién creada. Dado que hay más de una ventana con el título &quot;&quot; y la clase &quot; WorkerW&quot;, debemos recorrer el árbol de ventanas secuencialmente. Esto se puede hacer usando la función EnumWindows.</p>
<p>EnumWindows <strong>realiza llamadas EnumWindowProc para cada ventana de nivel superior</strong>. Desde ahí, podemos comprobar si la ventana actual contiene un elemento secundario llamado &ldquo;SHELLDLL_DefView&rdquo;, lo que indica que representa los iconos del escritorio. A continuación, tomamos el siguiente elemento secundario de esa ventana.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="c1">// Spy++ output</span>
</span></span><span class="line"><span class="cl"><span class="c1">// .....</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0x00010190 &#34;&#34; WorkerW</span>
</span></span><span class="line"><span class="cl"><span class="c1">//   ...</span>
</span></span><span class="line"><span class="cl"><span class="c1">//   0x000100EE &#34;&#34; SHELLDLL_DefView</span>
</span></span><span class="line"><span class="cl"><span class="c1">//     0x000100F0 &#34;FolderView&#34; SysListView32</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0x00100B8A &#34;&#34; WorkerW       &lt;-- Esta es la instancia</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 0x000100EC &#34;Program Manager&#34; Progman</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">IntPtr</span> <span class="n">workerw</span> <span class="p">=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">W32</span><span class="p">.</span><span class="n">EnumWindows</span><span class="p">(</span><span class="k">new</span> <span class="n">W32</span><span class="p">.</span><span class="n">EnumWindowsProc</span><span class="p">((</span><span class="n">tophandle</span><span class="p">,</span> <span class="n">topparamhandle</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">IntPtr</span> <span class="n">p</span> <span class="p">=</span> <span class="n">W32</span><span class="p">.</span><span class="n">FindWindowEx</span><span class="p">(</span><span class="n">tophandle</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                <span class="s">&#34;SHELLDLL_DefView&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Gets the WorkerW Window after the current one.</span>
</span></span><span class="line"><span class="cl">        <span class="n">workerw</span> <span class="p">=</span> <span class="n">W32</span><span class="p">.</span><span class="n">FindWindowEx</span><span class="p">(</span><span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                   <span class="n">tophandle</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                   <span class="s">&#34;WorkerW&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                   <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}),</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="prueba-1-dibujar-gráficos-entre-iconos-y-fondos-de-pantalla">Prueba 1: Dibujar gráficos entre iconos y fondos de pantalla</h3>
<p>Con el workerw obtenido, empieza la diversión. La primera prueba <strong>trata sobre cómo usar las clases System.Drawing para dibujar</strong> algo.</p>
<p>Esta prueba dibuja un rectángulo en la esquina superior izquierda del escritorio. Si usas varios monitores, ten en cuenta que el área del escritorio ocupa un rectángulo en todos ellos. Por lo tanto, asegúrate de que el monitor izquierdo esté encendido y que la ubicación del monitor asigne la esquina superior izquierda a un monitor, en caso de tener cuatro, uno encima de los otros tres.</p>
<div class="details admonition note">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>NOTA<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Todo lo que dibujes en esta capa permanecerá allí hasta que pintes sobre ella, la invalides o restablezcas tu fondo de pantalla.</div>
        </div>
    </div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">IntPtr</span> <span class="n">dc</span> <span class="p">=</span> <span class="n">W32</span><span class="p">.</span><span class="n">GetDCEx</span><span class="p">(</span><span class="n">workerw</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="p">(</span><span class="n">W32</span><span class="p">.</span><span class="n">DeviceContextValues</span><span class="p">)</span><span class="m">0x403</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">dc</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">using</span> <span class="p">(</span><span class="n">Graphics</span> <span class="n">g</span> <span class="p">=</span> <span class="n">Graphics</span><span class="p">.</span><span class="n">FromHdc</span><span class="p">(</span><span class="n">dc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">.</span><span class="n">FillRectangle</span><span class="p">(</span><span class="k">new</span> <span class="n">SolidBrush</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">White</span><span class="p">),</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">500</span><span class="p">,</span> <span class="m">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">W32</span><span class="p">.</span><span class="n">ReleaseDC</span><span class="p">(</span><span class="n">workerw</span><span class="p">,</span> <span class="n">dc</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="prueba-2-colocar-un-formulario-de-windows-detrás-de-los-iconos-del-escritorio">Prueba 2: Colocar un formulario de Windows detrás de los iconos del escritorio</h3>
<p>Esta prueba <strong>muestra cómo colocar un formulario Windows Form normal detrás de los iconos</strong> del escritorio. En esencia, esto se puede lograr asignando a nuestra ventana WorkerW el elemento principal de un formulario Windows Form. Para ello, podemos usar la función SetParent de la API de Windows.</p>
<div class="details admonition note">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>NOTA<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Para que esta función funcione, el formulario debe estar ya creado. El evento form.Load parece ser el lugar adecuado.</div>
        </div>
    </div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">Form</span> <span class="n">form</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Form</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">&#34;Prueba Window&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">form</span><span class="p">.</span><span class="n">Load</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="p">.</span><span class="n">Width</span> <span class="p">=</span> <span class="m">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="p">.</span><span class="n">Height</span> <span class="p">=</span> <span class="m">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="m">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Button</span> <span class="n">button</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Button</span><span class="p">()</span> <span class="p">{</span> <span class="n">Text</span> <span class="p">=</span> <span class="s">&#34;Catch Me&#34;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">form</span><span class="p">.</span><span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">button</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Random</span> <span class="n">rnd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Timer</span> <span class="n">timer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Timer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">timer</span><span class="p">.</span><span class="n">Interval</span> <span class="p">=</span> <span class="m">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">timer</span><span class="p">.</span><span class="n">Tick</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="p">((</span><span class="n">sender</span><span class="p">,</span> <span class="n">eventArgs</span><span class="p">)</span> <span class="p">=&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">button</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="n">rnd</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">form</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">button</span><span class="p">.</span><span class="n">Width</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">button</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="n">rnd</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">form</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">button</span><span class="p">.</span><span class="n">Height</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="n">timer</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">W32</span><span class="p">.</span><span class="n">SetParent</span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="n">workerw</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Application</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="n">form</span><span class="p">);</span>
</span></span></code></pre></div><h1 id="conclusión">Conclusión</h1>
<p>Un solo mandato para gobernarlos a todos 😄</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">W32</span><span class="p">.</span><span class="n">SendMessageTimeout</span><span class="p">(</span><span class="n">W32</span><span class="p">.</span><span class="n">FindWindow</span><span class="p">(</span><span class="s">&#34;Progman&#34;</span><span class="p">,</span> <span class="k">null</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                       <span class="m">0x052C</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="k">new</span> <span class="n">IntPtr</span><span class="p">(</span><span class="m">0</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                       <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="n">W32</span><span class="p">.</span><span class="n">SendMessageTimeoutFlags</span><span class="p">.</span><span class="n">SMTO_NORMAL</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="m">1000</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                       <span class="k">out</span> <span class="n">result</span><span class="p">);</span>
</span></span></code></pre></div><hr>
<figure><a class="lightgallery" href="/img/ref.png" title="/img/ref.png" data-thumbnail="/img/ref.png" data-sub-html="<h2>.</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/ref.png"
            data-srcset="/img/ref.png, /img/ref.png 1.5x, /img/ref.png 2x"
            data-sizes="auto"
            alt="/img/ref.png" />
    </a><figcaption class="image-caption">.</figcaption>
    </figure>
</div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2015 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://ninpl.com" target="_blank">N9&#43;</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"><link rel="stylesheet" href="/lib/aplayer/dark.min.css"><link rel="stylesheet" href="/css/898006.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.es.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":50},"comment":{},"data":{"id-1":"This is a \u003cem\u003eparagraph\u003c/em\u003e with \u003cstrong\u003etyping animation\u003c/strong\u003e based on \u003ca href=\"https://typeitjs.com/\" target=\"_blank\" rel=\"noopener noreffer \"\u003eTypeIt\u003c/a\u003e\u0026hellip;","id-2":["\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHelloWorld\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e","\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e","\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Hello World\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e","\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e","\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e"],"id-4":"graph LR;\n    A[Hard edge] --\u003e|Link text| B(Round edge)\n    B --\u003e C{Decision}\n    C --\u003e|One| D[Result one]\n    C --\u003e|Two| E[Result two]","id-5":"gitGraph\n    commit\n    commit\n    branch develop\n    checkout develop\n    commit\n    commit\n    checkout main\n    merge develop\n    commit\n    commit","id-6":"pie\n    \"Dogs\" : 386\n    \"Cats\" : 85\n    \"Rats\" : 15","id-7":" N9+","id-8":" N9+"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"es","maxResultLength":10,"noResultsFound":"No se encontraron resultados","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"],"id-7":["id-7"],"id-8":["id-8"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-V17LGH4N3N', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-V17LGH4N3N" async></script></body>
</html>
