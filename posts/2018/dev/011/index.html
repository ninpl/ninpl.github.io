<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Localización usando .PO - N9&#43;</title><meta name="Description" content="un blog sobre mi, juegos, desarrollo y anime"><meta property="og:title" content="Localización usando .PO" />
<meta property="og:description" content="Traducir un juego a múltiples idiomas es una forma muy efectiva de exponerlo a nuevas audiencias. Sin embargo, puede convertirse en un verdadero dolor de cabeza si no lo hace de forma extensible y mantenible. Un sistema .po es una gran manera de administrar traducciones, y es un sistema útil para saber más que solo juegos. Analizaré formas en que puede ampliar el sistema para que sea más robusto, pero la mayoría de los detalles de estos dependen demasiado de su configuración para ser detallados por completo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ninpl.com/posts/2018/dev/011/" /><meta property="og:image" content="https://ninpl.com/avatar.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-25T19:26:11+02:00" />
<meta property="article:modified_time" content="2018-09-25T19:26:11+02:00" /><meta property="og:site_name" content="N9&#43;" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ninpl.com/avatar.png"/>

<meta name="twitter:title" content="Localización usando .PO"/>
<meta name="twitter:description" content="Traducir un juego a múltiples idiomas es una forma muy efectiva de exponerlo a nuevas audiencias. Sin embargo, puede convertirse en un verdadero dolor de cabeza si no lo hace de forma extensible y mantenible. Un sistema .po es una gran manera de administrar traducciones, y es un sistema útil para saber más que solo juegos. Analizaré formas en que puede ampliar el sistema para que sea más robusto, pero la mayoría de los detalles de estos dependen demasiado de su configuración para ser detallados por completo."/>
<meta name="application-name" content="Moon Antonio">
<meta name="apple-mobile-web-app-title" content="Moon Antonio"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://ninpl.com/posts/2018/dev/011/" /><link rel="prev" href="https://ninpl.com/posts/2018/cplusplusunreal/001/" /><link rel="next" href="https://ninpl.com/posts/2018/dise%C3%B1o/001/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Localización usando .PO",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ninpl.com\/posts\/2018\/dev\/011\/"
        },"genre": "posts","keywords": "Moon Antonio, dev","wordcount":  1587 ,
        "url": "https:\/\/ninpl.com\/posts\/2018\/dev\/011\/","datePublished": "2018-09-25T19:26:11+02:00","dateModified": "2018-09-25T19:26:11+02:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "N9+"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="N9&#43;"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/avatar.png"
        data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x"
        data-sizes="auto"
        alt="/avatar.png"
        title="/avatar.png" /><span class="header-title-pre"><i class='fa fa-angle-right'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/devblog/"><i class='fa-solid fa-gamepad'></i> devblog </a><a class="menu-item" href="/backdoor/"><i class='fa-solid fa-user-secret'></i> backdoor </a><a class="menu-item" href="https://github.com/ninpl/rec.repos" rel="noopener noreffer" target="_blank"><i class='fa-solid fa-code'></i> src </a><a class="menu-item" href="/portfolio/"><i class='fa-solid fa-terminal'></i> moon </a><span class="menu-item delimiter"></span><a class="menu-item" href="https://github.com/moonantonio" title="GitHub" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-github-alt" aria-hidden="true"></i></a><a class="menu-item" href="https://gitlab.com/moonantonio" title="Gitlab" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-gitlab" aria-hidden="true"></i></a><a class="menu-item" href="https://trello.com/u/antoniomoon" title="Trello" rel="noopener noreffer" target="_blank"><i class="fa-brands fa-trello" aria-hidden="true"></i></a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Busca títulos o contenido..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Buscar">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Limpiar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="N9&#43;"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/avatar.png"
        data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x"
        data-sizes="auto"
        alt="/avatar.png"
        title="/avatar.png" /><span class="header-title-pre"><i class='fa fa-angle-right'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Busca títulos o contenido..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Buscar">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Limpiar">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancelar
                    </a>
                </div><a class="menu-item" href="/devblog/" title=""><i class='fa-solid fa-gamepad'></i>devblog</a><a class="menu-item" href="/backdoor/" title=""><i class='fa-solid fa-user-secret'></i>backdoor</a><a class="menu-item" href="https://github.com/ninpl/rec.repos" title="" rel="noopener noreffer" target="_blank"><i class='fa-solid fa-code'></i>src</a><a class="menu-item" href="/portfolio/" title=""><i class='fa-solid fa-terminal'></i>moon</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><article class="feature-image">
        <div class="header-img" style="background-image: url('https://ninpl.com/img/b/bg.jpg')"></div>
		</header></div>
    <article class="page single"><h1 class="single-title animate__animated animate__flipInX">Localización usando .PO</h1><div class="content" id="content"><p>Traducir un juego a múltiples idiomas es una forma muy efectiva de exponerlo a nuevas audiencias. Sin embargo, puede convertirse en un verdadero dolor de cabeza si no lo hace de forma extensible y mantenible. Un sistema .po es una gran manera de administrar traducciones, y es un sistema útil para saber más que solo juegos. Analizaré formas en que puede ampliar el sistema para que sea más robusto, pero la mayoría de los detalles de estos dependen demasiado de su configuración para ser detallados por completo.</p>
<p>Algo a tener en cuenta cuando decida traducir, es que su juego ya debería estar en un estado bastante maduro, ya que hacer traducciones (especialmente por los fanáticos) es difícil lograr que se actualicen cada vez que cambia o agrega texto.</p>
<p>Algunas cosas que ya debería haber configurado al entrar en esto son algún tipo de sistema de configuración, así como un sistema de interfaz de usuario y un objeto global DontDestroyOnLoad al que tiene acceso su UI.</p>
<p>Lo más probable es que lo actualice en algún momento, ya que incluso al escribir esto noté algunas optimizaciones que podría estar haciendo.</p>
<h2 id="traducciones">Traducciones</h2>
<p>Omita esta sección si solo quiere ver el flujo de trabajo, pero encontré que este sistema es útil para que los fanáticos me traduzcan las cosas. Lo mejor que puedes hacer es crear una hoja de cálculo de Google Drive y compartir el enlace con los fanáticos, que puedes encontrar haciendo publicaciones en los distintos centros para tu juego.</p>
<h2 id="el-archivo-po">El archivo .PO</h2>
<p>¿Qué es un archivo .po (objeto portátil)?. Es una parte del estándar gettext, y se describe en el proyecto GNU de esta manera:</p>
<p>Un archivo PO se compone de muchas entradas, cada entrada mantiene la relación entre una cadena original no traducida y su correspondiente traducción. Todas las entradas en un archivo PO generalmente pertenecen a un solo proyecto, y todas las traducciones se expresan en un solo idioma de destino. Una entrada de archivo PO tiene la siguiente estructura esquemática:</p>
<hr>
<pre tabindex="0"><code>white-space
#  translator-comments
#. extracted-comments
#: reference…
#, flag…
#| msgid previous-untranslated-string
msgid untranslated-string
msgstr translated-string
</code></pre><hr>
<p>¿Y qué? ¿Es solo un archivo con una clave y un valor y algunos metadatos? No del todo, hay dos partes más para usar un sistema .po que lo haga brillar realmente. Los archivos .pot y los editores.</p>
<p>Un .pot (Portable Object Template) es lo que se usa para generar sus archivos .po en un editor, y se puede usar para actualizar sus archivos .po cuando agrega nuevas traducciones. Tiene la misma estructura exacta que un archivo .po normal, pero con una cadena traducida vacía.</p>
<p>¡No intente administrar traducciones agregando entradas a archivos .po, actualice desde .pot para garantizar la coherencia!</p>
<p>El editor más popular es Poedit. Que se ve así, he marcado con un círculo el botón &lsquo;Actualizar desde POT&rsquo;:</p>
<figure><a class="lightgallery" href="/img/c/po.jpg" title="/img/c/po.jpg" data-thumbnail="/img/c/po.jpg" data-sub-html="<h2>.</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/c/po.jpg"
            data-srcset="/img/c/po.jpg, /img/c/po.jpg 1.5x, /img/c/po.jpg 2x"
            data-sizes="auto"
            alt="/img/c/po.jpg" />
    </a><figcaption class="image-caption">.</figcaption>
    </figure>
<h2 id="implementación-con-unity3d">Implementación con Unity3D</h2>
<p>Es probable que este sistema necesite ajustes en su situación exacta, pero intentaré mantenerlo lo más genérico posible. Aunque algunos de los pasos que tendrá que averiguar sera, dónde llamar algunas cosas por su cuenta. Vamos a usar las cadenas en inglés como nuestras teclas, ¡esto es muy importante! Mantenga su .pot actualizado. La idea es que dado que el juego comenzará en inglés cada vez que podamos tomar los valores predeterminados para el cuadro de texto y usarlos como ambas claves y los valores del idioma inglés.</p>
<p>Los archivos principales con los que trabajaremos son:</p>
<ul>
<li>template.pot - Almacenado en Recursos/Idiomas (crear si no existe)</li>
<li>spanish.po - Almacenado en Recursos/Idiomas (crear si no existe)</li>
<li>LanguageManager.cs: adjunto y referenciado por el administrador de juego global persistente</li>
<li>UILocalizeText.cs: se adjunta a cada objeto de texto de UI, controla la actualización de ese texto</li>
</ul>
<p>Debe adjuntar UILocalizeText.cs a cada cuadro de texto que desee traducir y tener un valor para él en los archivos .po y .pot.</p>
<p>Convierta LanguageManger en un objeto global no destruir en la carga, llame a LoadLanguage() cuando cambie de idioma y luego UpdateAllTextBoxes() cuando necesite actualizar su UI.</p>
<p>Nota: desde que actualicé Unity, parece que no reconoce los archivos .po como archivos de texto y no puede encontrar los archivos de traducción. Agregar .txt después de .po lo corrige (es decir, spanish.po.txt), pero para cargarlo en Poedit debe escribir el nombre en el cuadro de diálogo.</p>
<h2 id="scripts">Scripts</h2>
<p>En los siguientes scripts todo lo que dice YourGameManager debe ser reemplazado por sus sistemas. Intenté comentar los archivos para ser bastante descriptivos.</p>
<p>Para configurar y usar estos:
1 - Crea tres cuadros de texto con valores que corresponden a los valores en template.pot
2 - Adjunte UILocalizeText.cs a estos cuadros de texto
3 - Init LevelManager.cs
4 - LoadLanguage (&ldquo;español&rdquo;)
5 - UpdateAllTextBoxes()</p>
<h3 id="templatepot">Template.POT</h3>
<hr>
<pre tabindex="0"><code>#, fuzzy
msgid &#34;&#34;
msgstr &#34;&#34;
&#34;Project-Id-Version: Test\n&#34;
&#34;POT-Creation-Date: 2017-02-12 09:12-0500\n&#34;
&#34;PO-Revision-Date: 2015-10-27 19:11-0400\n&#34;
&#34;Last-Translator: \n&#34;
&#34;Language-Team: \n&#34;
&#34;Language: en\n&#34;
&#34;MIME-Version: 1.0\n&#34;
&#34;Content-Type: text/plain; charset=UTF-8\n&#34;
&#34;Content-Transfer-Encoding: 8bit\n&#34;
&#34;X-Generator: Poedit 1.8.11\n&#34;
&#34;X-Poedit-Basepath: .\n&#34;
&#34;Plural-Forms: nplurals=2; plural=(n != 1);\n&#34;
&#34;X-Poedit-KeywordsList: --keyword[-]\n&#34;
&#34;X-Poedit-SearchPath-0: .\n&#34;

msgid &#34;GOLD&#34;
msgstr &#34;&#34;

msgid &#34;SILVER&#34;
msgstr &#34;&#34;

msgid &#34;BRONZE&#34;
msgstr &#34;&#34;
</code></pre><hr>
<h3 id="spanishpotxt">Spanish.po.txt</h3>
<hr>
<pre tabindex="0"><code>#, fuzzy
msgid &#34;&#34;
msgstr &#34;&#34;
&#34;Project-Id-Version: Test\n&#34;
&#34;POT-Creation-Date: 2017-02-12 09:12-0500\n&#34;
&#34;PO-Revision-Date: 2015-10-27 19:11-0400\n&#34;
&#34;Last-Translator: \n&#34;
&#34;Language-Team: \n&#34;
&#34;Language: en\n&#34;
&#34;MIME-Version: 1.0\n&#34;
&#34;Content-Type: text/plain; charset=UTF-8\n&#34;
&#34;Content-Transfer-Encoding: 8bit\n&#34;
&#34;X-Generator: Poedit 1.8.11\n&#34;
&#34;X-Poedit-Basepath: .\n&#34;
&#34;Plural-Forms: nplurals=2; plural=(n != 1);\n&#34;
&#34;X-Poedit-KeywordsList: --keyword[-]\n&#34;
&#34;X-Poedit-SearchPath-0: .\n&#34;

msgid &#34;GOLD&#34;
msgstr &#34;ORO&#34;

msgid &#34;SILVER&#34;
msgstr &#34;PLATA&#34;

msgid &#34;BRONZE&#34;
msgstr &#34;BRONCE&#34;
</code></pre><hr>
<h3 id="languajemanagercs">LanguajeManager.cs</h3>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">LanguageManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//This is where the current loaded language will go</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">static</span> <span class="n">Hashtable</span> <span class="n">textTable</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [HideInInspector]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Just a reference for the current language, default to english</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">CurrentLanguage</span> <span class="p">=</span> <span class="s">&#34;english&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//Run this when you are ready to start the language process, you usually want to do this after everything has loaded</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//You should use an enum for storing settings that are a unique list,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//This gets a string representation of an enum, </span>
</span></span><span class="line"><span class="cl">        <span class="n">CurrentLanguage</span> <span class="p">=</span> <span class="n">Enum</span><span class="p">.</span><span class="n">GetName</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Settings</span><span class="p">.</span><span class="n">Languages</span><span class="p">),</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">YourGameManager</span><span class="p">.</span><span class="n">Settings</span><span class="p">.</span><span class="n">Language</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//Pass that language into LoadLanguage, remember we are in init so this should only run once.</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoadLanguage</span><span class="p">(</span><span class="n">CurrentLanguage</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//You call this when you want to update all text boxes with the new translation.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Run this after Init</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Run this whenever you run LoadLanguage</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Run this whenever you load a new scene and want to translate the new UI</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">UpdateAllTextBoxes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>      
</span></span><span class="line"><span class="cl">        <span class="c1">//Find all active and inactive text boxes and loop through &#39;em</span>
</span></span><span class="line"><span class="cl">        <span class="n">UILocalizeText</span><span class="p">[]</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">Resources</span><span class="p">.</span><span class="n">FindObjectsOfTypeAll</span><span class="p">&lt;</span><span class="n">UILocalizeText</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="n">UILocalizeText</span> <span class="n">text_box</span> <span class="k">in</span> <span class="n">temp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//Run the update translation function on each text </span>
</span></span><span class="line"><span class="cl">            <span class="n">text_box</span><span class="p">.</span><span class="n">UpdateTranslation</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//Run this whenever a language changes, like in when a setting is changed - then run UpdateAllTextBoxes</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//This is based off of http://wiki.unity3d.com/index.php?title=TextManager, though heavily modified and expanded</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">LoadLanguage</span><span class="p">(</span><span class="kt">string</span> <span class="n">lang</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">CurrentLanguage</span> <span class="p">=</span> <span class="n">lang</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">lang</span> <span class="p">==</span> <span class="s">&#34;english&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">UpdateAllTextBoxes</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lang</span> <span class="p">!=</span> <span class="s">&#34;english&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">string</span> <span class="n">fullpath</span> <span class="p">=</span> <span class="s">&#34;Languages/&#34;</span> <span class="p">+</span> <span class="n">lang</span> <span class="p">+</span> <span class="s">&#34;.po&#34;</span><span class="p">;</span> <span class="c1">// the file is actually &#34;.txt&#34; in the end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">TextAsset</span> <span class="n">textAsset</span> <span class="p">=</span> <span class="p">(</span><span class="n">TextAsset</span><span class="p">)</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="n">fullpath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">textAsset</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&#34;[TextManager] &#34;</span> <span class="p">+</span> <span class="n">fullpath</span> <span class="p">+</span> <span class="s">&#34; file not found.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&#34;[TextManager] loading: &#34;</span> <span class="p">+</span> <span class="n">fullpath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">textTable</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">textTable</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Hashtable</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">textTable</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">StringReader</span> <span class="n">reader</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">textAsset</span><span class="p">.</span><span class="n">text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="kt">string</span> <span class="n">key</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="kt">string</span> <span class="n">val</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="kt">string</span> <span class="n">line</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="p">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">())</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">&#34;msgid \&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">key</span> <span class="p">=</span> <span class="n">line</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">8</span><span class="p">).</span><span class="n">ToUpper</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">&#34;msgstr \&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">val</span> <span class="p">=</span> <span class="n">line</span><span class="p">.</span><span class="n">Substring</span><span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">else</span>
</span></span><span class="line"><span class="cl">                    <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">val</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="c1">// TODO: add error handling here in case of duplicate keys</span>
</span></span><span class="line"><span class="cl">                            <span class="n">textTable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="n">key</span> <span class="p">=</span> <span class="n">val</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//This handles selecting the value from the translation array and returning it, the UILocalizeText calls this</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">GetText</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">textTable</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">textTable</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="p">=</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">textTable</span><span class="p">[</span><span class="n">key</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="uilocalizetextcs">UILocalizeText.cs</h2>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">UnityEngine.UI</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">UILocalizeText</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//This instances key, as well as the english translation</span>
</span></span><span class="line"><span class="cl"><span class="na">    [HideInInspector]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="kt">string</span> <span class="n">TranslationKey</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [HideInInspector]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">Text</span> <span class="n">TextToTranslate</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//References to text values</span>
</span></span><span class="line"><span class="cl">    <span class="kt">string</span> <span class="n">OriginalText</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">string</span> <span class="n">TranslatedText</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//This gets run automatically if the original text hasn&#39;t been set when you go to update it. </span>
</span></span><span class="line"><span class="cl">    <span class="c1">//You shouldn&#39;t need to manually run this from anywhere</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">Init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Grab the TextToTranslate if we haven&#39;t</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">TextToTranslate</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">TextToTranslate</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Text</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//Grab the original value of the text before we update it</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">TextToTranslate</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">OriginalText</span> <span class="p">=</span> <span class="n">TextToTranslate</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//Set the translation key to the original english text</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">TranslationKey</span> <span class="p">==</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">TranslationKey</span> <span class="p">=</span> <span class="n">OriginalText</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//This gets called from LanguageManager</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//One thing I noticed is that it might be nicer to just pass in the correct string to this rather than go grap it from LanguageManager</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">UpdateTranslation</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//If original text is empty, then this object hasn&#39;t been initiated so it should do that </span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">OriginalText</span> <span class="p">==</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">Init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//If the object has no Text object then we shouldn&#39;t try to set the text so just stop</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">TextToTranslate</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">YourGameManager</span><span class="p">.</span><span class="n">LanguageManager</span><span class="p">.</span><span class="n">CurrentLanguage</span> <span class="p">!=</span> <span class="s">&#34;english&#34;</span> <span class="p">&amp;&amp;</span> <span class="n">TranslationKey</span> <span class="p">!=</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">string</span> <span class="n">new_text</span> <span class="p">=</span> <span class="n">YourGameManager</span><span class="p">.</span><span class="n">LanguageManager</span><span class="p">.</span><span class="n">GetText</span><span class="p">(</span><span class="n">TranslationKey</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">new_text</span> <span class="p">!=</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">TextToTranslate</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">new_text</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">               <span class="c1">// Debug.Log(&#34;Key &#34; + OriginalText + &#34; doesn&#39;t have an entry in this language&#34;);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">YourGameManager</span><span class="p">.</span><span class="n">LanguageManager</span><span class="p">.</span><span class="n">CurrentLanguage</span> <span class="p">==</span> <span class="s">&#34;english&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">TextToTranslate</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">OriginalText</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">TextToTranslate</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">OriginalText</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<p>Bueno con esto, puedes hacer la prueba y comprobar que ya tienes un sistema simple para traducir tu juego a diversos idiomas.</p>
<hr>
<figure><a class="lightgallery" href="/img/ref.png" title="/img/ref.png" data-thumbnail="/img/ref.png" data-sub-html="<h2>.</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/img/ref.png"
            data-srcset="/img/ref.png, /img/ref.png 1.5x, /img/ref.png 2x"
            data-sizes="auto"
            alt="/img/ref.png" />
    </a><figcaption class="image-caption">.</figcaption>
    </figure>
</div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2016 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://ninpl.com" target="_blank">N9&#43;</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.es.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":50},"comment":{},"data":{"id-1":" Antonio Moon","id-2":" Antonio Moon"},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"es","maxResultLength":10,"noResultsFound":"No se encontraron resultados","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-V17LGH4N3N', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-V17LGH4N3N" async></script></body>
</html>
